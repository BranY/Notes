<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.1.1 (456663)"/><meta name="altitude" content="11.38462257385254"/><meta name="author" content="杨文家"/><meta name="created" content="2018-05-19 12:46:44 +0000"/><meta name="latitude" content="30.19547523312549"/><meta name="longitude" content="120.1919652606613"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-05-20 08:09:15 +0000"/><title>FM &amp; FFM</title></head><body><div><font style="font-size: 24px;"><span style="color: rgb(170, 121, 66);">FM</span><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); color: rgb(170, 121, 66); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">旨在解决大规模稀疏数据下的特征组合问题</span></font></div><div><font style="font-size: 14px;"><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); font-size: 14px; color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">由</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><span style="font-size: 14px; background-color: rgb(250, 250, 250); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; color: rgb(255, 38, 0);">one-hot编码带来的数据稀疏性会导致特征空间变大</span></span><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); font-size: 14px; color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">。一维categorical特征在经过one-hot编码后变成了10维数值型特征。真实应用场景中，未编码前特征总维度可能仅有数十维或者到数百维的categorical型特征，经过one-hot编码后，达到数千万、数亿甚至更高维度的数值特征在业内都是常有的。<span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">特征空间增长的维度取决于categorical型特征的取值个数</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">。在数据稀疏性的现实情况下，我们如何去利用这些特征来提升learning performance？</span></span></font></div><div><br/></div><div><font style="font-size: 18px;" color="#aa7942">(1).  为啥要考虑特征间的关联信息</font></div><div><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">大量的研究和实际数据分析结果表明：某些特征之间的关联信息（相关度）对事件结果的的发生会产生很大的影响。从实际业务线的广告点击数据分析来看，也正式了这样的结论。</span></div><div><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><br/></span></div><div><font style="font-size: 18px;" color="#aa7942">(2).  如何表达特征之间的关联</font></div><div><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; line-height: 1.5; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);-en-paragraph:true;">表示特征之间的关联，最直接的方法的是构造组合特征。样本中特征之间的关联信息在one-hot编码和浅层学习模型（如LR、SVM）是做不到的。目前工业界主要有两种手段得到组合特征：
</span></div><ul><li><div style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 16px; list-style-type: decimal;"><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-size: 16px;">人工特征工程（数据分析＋人工构造）；</span><br/></div></li><li><div><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-size: 16px;">通过模型做组合特征的学习（深度学习方法、FM/FFM方法）</span><br/></div></li></ul><div><br/></div><div>二阶多项式回归模型</div><div style="text-align: center; "><img src="FM%20&amp;%20FFM.resources/44E24E98-398D-41C6-AFFE-AD95D5DE893E.png" height="310" width="1638"/></div><div><br/></div><div><font style="font-size: 14px;"><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">交叉项中的组合特征参数总共有</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1001.98em, 4.273em, -999.997em); top: -4.529em;">n</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1001.98em, 4.273em, -999.997em); top: -4.529em;">(</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1001.98em, 4.273em, -999.997em); top: -4.529em;">n</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1001.98em, 4.273em, -999.997em); top: -4.529em;">−</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1001.98em, 4.273em, -999.997em); top: -4.529em;">1</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1001.98em, 4.273em, -999.997em); top: -4.529em;">)/</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -3.643em;">2</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">个。在这里，</span><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">任意两个交叉项参数</span><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: nowrap; widows: 2; word-spacing: normal; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); line-height: normal; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; top: 0px; clip: rect(1px, 1px, 1px, 1px); overflow: hidden !important;">wij</span><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">都是独立的</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">。然而，在数据非常稀疏的实际应用场景中，交叉项参数的学习是很困难的。</span></font></div><div><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><font style="font-size: 14px;"><br/></font></span></div><div><font style="font-size: 14px;"><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">因为我们知道，</span><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">回归模型的参数</span><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: nowrap; widows: 2; word-spacing: normal; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); line-height: normal; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.93em, 1000.68em, 2.659em, -999.997em); top: -2.497em;">w</span><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">的学习结果就是从训练样本中计算充分统计量（凡是符合</span><a href="https://en.wikipedia.org/wiki/Exponential_family" style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(44, 166, 203); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">指数族分布</a><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">的模型都具有此性质）</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">，而在这里交叉项的每一个参数</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em;">w</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;">i</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;">j</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">的学习过程需要大量的</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em;">x</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.357em, 1002.29em, 2.763em, -999.997em); top: -3.852em;">i</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.357em, 1002.29em, 2.763em, -999.997em); top: -2.289em;">、</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em;">x</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.357em, 1002.29em, 2.763em, -999.997em); top: -3.852em;">j</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">同时非零的训练样本数据。由于样本数据本来就很稀疏，能够满足“</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em;">x</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1000.73em, 2.503em, -999.997em); top: -3.852em;">i</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">和</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em;">x</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1000.73em, 2.659em, -999.997em); top: -3.852em;">j</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">都非零”的样本数就会更少。训练样本不充分，学到的参数</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em;">w</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;">i</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;">j</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">就不是充分统计量结果，导致参数</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em;">w</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;">i</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;">j</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="background-color: rgb(250, 250, 250);">不准确，而这会严重影响模型预测的效果（performance）和稳定性。</span><span style="background-color: rgb(250, 250, 250); color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">那么，</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 250, 165);-evernote-highlight:true;">如何在降低数据稀疏问题给模型性能带来的重大影响的同时，有效地解决二阶交叉项参数的学习问题呢</span><span style="background-color: rgb(250, 250, 250); color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">？</span></span></font></div><div><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><br/></span></div><div><font style="font-size: 14px;"><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; line-height: 1.5; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);-en-paragraph:true;">根据矩阵分解的启发，如果把多项式模型中二阶交叉项参数</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: nowrap; widows: 2; word-spacing: normal; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em;-en-paragraph:true;">w</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: nowrap; widows: 2; word-spacing: normal; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;-en-paragraph:true;">i</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: nowrap; widows: 2; word-spacing: normal; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;-en-paragraph:true;">j</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; line-height: 1.5; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);-en-paragraph:true;">组成一个对称矩阵</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: nowrap; widows: 2; word-spacing: normal; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.669em, 1000.89em, 2.659em, -999.997em); top: -2.497em;-en-paragraph:true;">W</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; line-height: 1.5; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);-en-paragraph:true;">（对角元素设为正实数），</span><font color="#ff2600"><span style="font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; orphans: 2; widows: 2; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; line-height: 1.5; font-variant-ligatures: normal;-en-paragraph:true;">将每个交叉项参数</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em;-en-paragraph:true;">w</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;-en-paragraph:true;">i</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1001.15em, 2.659em, -999.997em); top: -3.852em;-en-paragraph:true;">j</span><span style="font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; orphans: 2; widows: 2; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; line-height: 1.5; font-variant-ligatures: normal;-en-paragraph:true;">用隐向量的内积</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1002.76em, 2.971em, -999.997em); top: -2.497em;-en-paragraph:true;">⟨</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -4.008em;-en-paragraph:true;">v</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1002.76em, 2.971em, -999.997em); top: -3.852em;-en-paragraph:true;">i</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1002.76em, 2.971em, -999.997em); top: -2.497em;-en-paragraph:true;">,</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -4.008em;-en-paragraph:true;">v</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1002.76em, 2.971em, -999.997em); top: -3.852em;-en-paragraph:true;">j</span><span style="orphans: 2; widows: 2; word-spacing: normal; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; line-height: normal; font-variant-ligatures: normal; white-space: nowrap; word-wrap: normal; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; clip: rect(1.617em, 1002.76em, 2.971em, -999.997em); top: -2.497em;-en-paragraph:true;">⟩</span><span style="font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; orphans: 2; widows: 2; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; line-height: 1.5; font-variant-ligatures: normal;-en-paragraph:true;">表示，是FM模型的核心思想</span></font><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; orphans: 2; widows: 2; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; line-height: 1.5; font-variant-ligatures: normal;-en-paragraph:true;">。</span></font></div><div><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; orphans: 2; widows: 2; background-color: rgb(250, 250, 250); -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; line-height: 1.5; font-variant-ligatures: normal;-en-paragraph:true;"><br/></span></div><div><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; line-height: 1.5; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); font-weight: bold;-en-paragraph:true;"><font style="font-size: 18px;">FM模型表达</font></span></div><div style="text-align: center; "><img src="FM%20&amp;%20FFM.resources/BE7E18E3-FE16-46E9-95F9-3194DEE37777.png" height="430" width="1458"/></div><div><br/></div><ul><li><div><span style="caret-color: rgb(65, 63, 63); font-size: 16px;"><font color="#413f3f">线形模型+交叉项：</font><span style="color: rgb(65, 63, 63); font-size: 16px;">直观地看FM模型表达式，前两项是线性回归模型的表达式，最后一项是二阶特征交叉项（又称组合特征项），表示模型将两个互异的特征分量之间的关联信息考虑进来。</span><span style="font-size: 16px;"><font color="#ff2600">用交叉项表示组合特征，从而建立特征与结果之间的非线性关系</font></span><span style="color: rgb(65, 63, 63); font-size: 16px;">。</span></span></div></li></ul><div><span style="font-size: 16px; color: rgb(65, 63, 63);"><br/></span></div><ul><li><div><font color="#413f3f"><span style="font-size: 16px;">交叉项系数 -》隐向量内积：</span></font><span style="font-size: 16px; color: rgb(65, 63, 63);">- 由于FM模型是在线性回归基础上加入了特征交叉项，模型求解时不直接求特征交叉项的系数wij（因为对应的组合特征数据稀疏，参数学习不充分），故而采用隐向量的内积⟨vi,vj表示wij。</span></div></li></ul><div><span style="color: rgb(65, 63, 63); font-size: 16px;">        具体的，FM求解过程中的做法是：对每一个特征分量xi引入隐向量vi＝(vi,1,vi,2,⋯,vi,k)，利用viv^Tj内积结果对交叉项的系数wij进行估计</span><br/></div><ul><li><div><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">二阶交叉项的参数由</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; font-size: 19.2px; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.93em, 1001.83em, 2.659em, -999.997em); top: -2.497em;">n</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; font-size: 19.2px; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.93em, 1001.83em, 2.659em, -999.997em); top: -2.497em;">⋅</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; font-size: 19.2px; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.93em, 1001.83em, 2.659em, -999.997em); top: -2.497em;">n</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">个减少到</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; font-size: 19.2px; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.669em, 1001.77em, 2.659em, -999.997em); top: -2.497em;">n</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Regular; font-size: 19.2px; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.669em, 1001.77em, 2.659em, -999.997em); top: -2.497em;">⋅</span><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: STIXGeneral-Italic; font-size: 19.2px; line-height: normal; text-indent: 0px; text-transform: none; letter-spacing: normal; word-spacing: 0px; word-wrap: normal; white-space: nowrap; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; color: rgb(65, 63, 63); font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250); clip: rect(1.669em, 1001.77em, 2.659em, -999.997em); top: -2.497em;">k</span><span style="color: rgb(65, 63, 63); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">个，远少于二阶多项式模型中的参数数量</span></div></li></ul><ul><li style=""><div><span style="font-size: 16px; color: rgb(65, 63, 63);" /></div></li></ul><div><span style="font-size: 18px;"><br/></span></div><div><span style="font-size: 18px;">FM总结：</span></div><div><span style="font-size: 18px;">1.<font color="#ff2600">FM降低了交叉项参数学习不充分的影响 （<span style="box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;">降低了因数据稀疏，导致交叉项参数学习不充分的影响</span>）</font></span></div><div><span style="font-size: 18px;"><font color="#ff2600"><br/></font></span></div><div><font style="font-size: 14px;">one-hot编码后的样本数据非常稀疏，组合特征更是如此。为了解决交叉项参数学习不充分、导致模型有偏或不稳定的问题。作者借鉴矩阵分解的思路：每一维特征用k维的隐向量表示，交叉项的参数wij用对应特征隐向量的内积表示，即⟨vi,vj⟩（也可以理解为平滑技术）。这样参数学习由之前学习交叉项参数wij的过程，转变为学习n个单特征对应k维隐向量的过程。</font></div><div>很明显，单特征参数（k维隐向量vi）的学习要比交叉项参数wij学习得更充分。示例说明：</div><div style="text-align: center; "><img src="FM%20&amp;%20FFM.resources/AE4A5E79-C4D8-4D4B-BA4B-2490121BE417.png" height="736" width="1662"/></div><div><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;"><font color="#ff2600" style="font-size: 18px;">2. FM提升了模型预估能力</font></span></div><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;">依然看上面的示例，样本中没有</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; font-size: 0.9em; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); border: 1px solid rgb(221, 221, 221); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;-en-paragraph:true;">&lt;男性，化妆品&gt;</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;">交叉特征，即没有男性看化妆品广告的数据。如果用多项式模型来建模，对应的交叉项参数w男性,化妆品是学不出来的，因为数据中没有对应的共现交叉特征。那么多项式模型就不能对出现的男性看化妆品广告场景给出准确地预估。</span></div><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;">FM模型是否能得到交叉项参数w男性,化妆品呢？答案是肯定的。由于FM模型是把交叉项参数用对应的特征隐向量内积表示，这里表示为w男性,化妆品=⟨v男性,v化妆品⟩</span></div><blockquote style="box-sizing: border-box; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px;-en-paragraph:true;">用</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; font-size: 0.9em; border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;-en-paragraph:true;">男性</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px;-en-paragraph:true;">特征隐向量v男性v男性和</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; font-size: 0.9em; border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;-en-paragraph:true;">化妆品</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px;-en-paragraph:true;">特征隐向量v化妆品v化妆品的内积表示交叉项参数w男性,化妆品w男性,化妆品。</span></div></blockquote><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;">由于FM学习的参数就是单特征的隐向量，那么男性看化妆品广告的预估结果可以用⟨v男性,v化妆品⟩得到。这样，即便训练集中没有出现男性看化妆品广告的样本，FM模型仍然可以用来预估，提升了预估能力。</span></div><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;"><font color="#ff2600" style="font-size: 18px;">3. FM提升了参数学习效率</font></span></div><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;">这个显而易见，参数个数由(n^2+n+1)变为(nk+n+1)个，模型训练复杂度也由O(mn^2)变为O(mnk)。m为训练样本数。对于训练样本和特征数而言，都是线性复杂度。</span></div><div style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); margin-top: 1em; margin-bottom: 1em;"><span style="color: rgb(51, 51, 51); box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;">此外，就FM模型本身而言，它是在多项式模型基础上对参数的计算做了调整，因此也有人</span><span style="color: rgb(51, 51, 51); box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;-en-paragraph:true;">把</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-weight: bold;-en-paragraph:true;"><font color="#ff2600">FM模型称为多项式的广义线性模型</font></span><span style="color: rgb(51, 51, 51); box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;">，也是恰如其分的。</span></div><div><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-weight: bold;-en-paragraph:true;">从交互项的角度看，FM仅仅是一个可以表示特征之间交互关系的函数表法式</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);-en-paragraph:true;">，可以推广到更高阶形式，即将多个互异特征分量之间的关联信息考虑进来。例如在广告业务场景中，如果考虑</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: Consolas, &quot;Liberation Mono&quot;, Courier, monospace; font-size: 0.9em; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 248, 248); border: 1px solid rgb(221, 221, 221); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;-en-paragraph:true;">User-Ad-Context</span><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;">三个维度特征之间的关系，在FM模型中对应的degree为3。</span></div><div><span style="box-sizing: border-box; -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Open Sans&quot;, &quot;Clear Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-variant-caps: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; white-space: pre-wrap; word-spacing: 0px; -webkit-text-stroke-width: 0px;-en-paragraph:true;"><br/></span></div><div><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; color: rgb(238, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><font style="font-size: 18px;">FM模型对稀疏数据有更好的学习能力，通过交互项可以学习特征之间的关联关系，并且保证了学习效率和预估能力。</font></span></div><div><span style="font-weight: bold; -webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; color: rgb(238, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);"><br/></span></div><div><span style="-webkit-margin-before: 0px; -webkit-margin-after: 0px; border: 0px; outline: 0px; font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif; font-size: 16px; color: rgb(238, 0, 0); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 250, 250);">FFM: 隐向量不仅与特征相关，且与域也相关</span></div><div><span style="font-size: 16px;">给出FFM－Fields特征组合的工作过程：</span></div><div><img src="FM%20&amp;%20FFM.resources/D03C4FA7-A78F-49B0-A6F0-EA11E5FDB327.png" height="1022" width="1946"/></div><div><img src="FM%20&amp;%20FFM.resources/E618675E-C038-47C5-8B7D-7BA49DC6A27D.png" height="640" width="1918"/></div><div><span style="font-size: 18px;"><br/></span></div><div><span style="font-size: 18px;">小细节：</span></div><ul><li><div><font style="font-size: 14px;"><font color="#ff2600">样本归一化</font>。FFM默认是进行样本数据的归一化，即 pa.norm为真；若此参数设置为假，很容易造成数据inf溢出，进而引起梯度计算的nan错误。因此，样本层面的数据是推荐进行归一化的。</font><br/></div></li></ul><div><font style="font-size: 14px;"><br/></font></div><ul><li><div><font style="font-size: 14px;"><font color="#ff2600">特征归一化</font>。CTR/CVR模型采用了多种类型的源特征，包括数值型和categorical类型等。但是，categorical类编码后的特征取值只有0或1，较大的数值型特征会造成样本归一化后categorical类生成特征的值非常小，没有区分性。例如，一条用户-商品记录，用户为“男”性，商品的销量是5000个（假设其它特征的值为零），那么归一化后特征“sex=male”（性别为男）的值略小于0.0002，而“volume”（销量）的值近似为1。特征“sex=male”在这个样本中的作用几乎可以忽略不计，这是相当不合理的。因此，将源数值型特征的值归一化到 0,1 是非常必要的。</font><br/></div></li></ul><div><font style="font-size: 14px;"><br/></font></div><ul><li><div><font style="font-size: 14px;"><font color="#ff2600">省略零值特征</font>。从FFM模型的表达式(4)(4)可以看出，零值特征对模型完全没有贡献。包含零值特征的一次项和组合项均为零，对于训练模型参数或者目标值预估是没有作用的。因此，可以省去零值特征，提高FFM模型训练和预测的速度，这也是稀疏样本采用FFM的显著优势。</font><br/></div></li></ul><div><br style="font-size: 18px;"/></div><div><span style="font-size: 18px;"><br/></span></div><div><span style="font-size: 18px;">FM与其他模型对比</span></div><ul><li><div> FM是一种比较灵活的模型，通过合适的特征变换方式，FM可以模拟二阶多项式核的SVM模型、MF模型、SVD++模型等</div></li><li><div>相比SVM的二阶多项式核而言，FM在样本稀疏的情况下是有优势的；而且，FM的训练/预测复杂度是线性的，而二项多项式核$SVM$需要计算核矩阵，核矩阵复杂度就是N平方。</div></li><li><div>相比MF而言，把MF中每一项的rating分改写为 $r_{ui} \sim \beta_u + \gamma_i + x_u^T y_i$，从公式[(2)]中可以看出，这相当于只有两类特征 u 和 i的FM模型。对于FM而言，可以加任意多的特征，比如user的历史购买平均值，item的历史购买平均值等，**但是$MF$只能局限在两类特征。SVD++与MF类似，在特征的扩展性上都不如FM，在此不再赘述。</div></li></ul><div><br/></div><div><br/></div><div>参考链接：</div><ul><li><div><a href="https://www.zhihu.com/question/48552549">隐向量是什么？ </a>                                                                       </div></li><li><div><a href="https://www.52caml.com/head_first_ml/ml-chapter9-factorization-family/">FM家族 </a>                                                                                </div></li><li><div><a href="http://www.cs.cmu.edu/~wcohen/10-605/2015-guest-lecture/FM.pdf">FM </a>                                                                                         </div></li><li><div><a href="http://www.algo.uni-konstanz.de/members/rendle/pdf/Rendle2010FM.pdf">FM论文</a>                                                                                 </div></li><li><div><a href="https://tech.meituan.com/deep-understanding-of-ffm-principles-and-practices.html">FFM原理与实践   </a>                                                                    </div></li><li><div><a href="https://tech.meituan.com/deep-understanding-of-ffm-principles-and-practices.html">FFM   </a>                                                                                     </div></li><li><div><a href="https://github.com/guestwalk/libffm">lib-ffm </a>                                                                                     </div></li></ul><div><br/></div></body></html>